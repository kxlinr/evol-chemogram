"0","#Normalize expression using scale(), by genes (columns)"
"0","exprs_norm = raw_exprs #Copy the original data"
"0","exprs_norm[,3:ncol(exprs_norm)] = scale(exprs_norm[,3:ncol(exprs_norm)], center=TRUE, scale=TRUE) #center = subtract by the mean; scale = divide by stdev"
"0",""
"0",""
"0","#Clean + reformat a bit"
"0","exprs_norm = exprs_norm %>%"
"0","  dplyr::select(-GENE_title) %>% #remove the extra descriptor column"
"0","  filter(!(GENE_SYMBOLS %in% dup_genes_gdsc)) %>% # remove duplicated genes"
"0","  mutate(GENE_SYMBOLS = str_replace_all(GENE_SYMBOLS, ""-"", ""_"")) %>% #replace any - with _"
"0","  gather(COSMIC_ID, value, -GENE_SYMBOLS) %>% #convert to long format (excluding the gene symbols col)"
"0","  spread(GENE_SYMBOLS, value) #convert back to wide format, with genes as colnames"
"0","  #filter(COSMIC_ID %in% cell_lines_filtered$cosmic_id) #include only epithelial cancer types; we'll do this at the end of the analysis instead"
