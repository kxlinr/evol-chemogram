} else if (method1 == "oncoPredict") {
x.col = "#6d597a"
} else if (method1 == "upSigs") {
x.col = "#6a040f"
} else if (method1 == "updownSigs") {
x.col = "#c9184a"
}
if(method2=="SimpleSigs"){
y.col = "#e07a5f"
} else if (method2 == "oncoPredict") {
y.col = "#6d597a"
} else if (method2 == "upSigs") {
y.col = "#6a040f"
} else if (method2 == "updownSigs") {
y.col = "#c9184a"
}
#plot with the legend, save individually
# plot_indiv = ggplot(data3, aes(x=method1_acc, y=method2_acc, col=subtype.x)) +
#   geom_point(size=2, alpha=0.8) +
#   scale_color_manual(values=c("#FF0000", "#A40000", "#D83601", "#D85701", "#D88D01",
#                               "#FFAB04", "#FFCD04", "#FFE204", "#E0E400", "#BAE400",
#                               "#A0E400", "#5BE400", "#0BFF48", "#23C200", "#01A851",
#                               "#03A46C", "#03CFA3", "#03CFB8", "#03BECF", "#02BEF2",
#                               "#028BC5", "#0264C5", "#0414CA", "#5234E8", "#7C34E8",
#                               "#A334E8", "#CA34E8", "#F03FE5", "#8C0C7F", "#8C0C41")) +
#   labs(title = "Accuracy Score Correlation",
#        subtitle=paste0("Spearman's rho = ", round(rho, 3)),
#        x=method1,
#        y=method2,
#        col="Disease Site") +
#   theme(axis.text=element_text(size=12))
#
# ggsave(here("Plots", "Method Comparison",
#             paste0(method1,".v.", method2, "_cor.png")),
#        plot=plot_indiv,
#        width=5, height=4)
#plot without legend, to put together in a multipanel figure
plot = ggplot(data3, aes(x=method1_acc, y=method2_acc, col=subtype.x)) +
geom_point(size=1, alpha=0.8) +
scale_color_manual(values=c("#FF0000", "#A40000", "#D83601", "#D85701", "#D88D01",
"#FFAB04", "#FFCD04", "#FFE204", "#E0E400", "#BAE400",
"#A0E400", "#5BE400", "#0BFF48", "#23C200", "#01A851",
"#03A46C", "#03CFA3", "#03CFB8", "#03BECF", "#02BEF2",
"#028BC5", "#0264C5", "#0414CA", "#5234E8", "#7C34E8",
"#A334E8", "#CA34E8", "#F03FE5", "#8C0C7F", "#8C0C41")) +
labs(title = paste0("rho = ", round(rho, 3)),
x=method1,
y=method2) +
scale_x_continuous(breaks=c(0, 0.5, 1)) +
scale_y_continuous(breaks=c(0, 0.5, 1)) +
theme(axis.text=element_text(size=12),
legend.position="none",
axis.title.x=element_text(color=x.col),
axis.title.y=element_text(color=y.col))
return(plot)
}
p1 = plot_cor(data=plot5,
method1="upSigs", method2="SimpleSigs")
p2 = plot_cor(data=plot5,
method1="upSigs", method2="oncoPredict")
p3 = plot_cor(data=plot5,
method1="upSigs", method2="updownSigs")
p4 = plot_cor(data=plot5,
method1="updownSigs", method2="SimpleSigs")
p5 = plot_cor(data=plot5,
method1="updownSigs", method2="oncoPredict")
p6 = plot_cor(data=plot5,
method1="oncoPredict", method2="SimpleSigs")
p1+p2+p3+p4+p5+p6 + plot_annotation(title="Accuracy Score Correlation")
ggsave(here("Plots", "Method Comparison", "spearman_method_comparison.png"),
width=7, height=6)
ggsave(here("Plots", "Method Comparison", "spearman_method_comparison.png"),
width=6, height=5)
ggsave(here("Plots", "Method Comparison", "spearman_method_comparison.png"),
width=5, height=4)
plot_cor = function(data, method1, method2, withlegend){
#sort the data
data1 = data %>%
filter(Method==method1) %>%
mutate(method1_acc = Accuracy)
data2 = data %>%
filter(Method==method2) %>%
mutate(method2_acc = Accuracy)
data3 = inner_join(data1 %>% select(cell_line, subtype.x, method1_acc),
data2 %>% select(cell_line, subtype.x, method2_acc),
by=c("cell_line", "subtype.x"))
#calculate spearman correlation
cl1 = unique(data1$cell_line)
cl2 = unique(data2$cell_line)
data1 = data1 %>% filter(cell_line %in% cl2)
data2 = data2 %>% filter(cell_line %in% cl1)
data2 = data2[match(data1$cell_line,data2$cell_line),]
rho = cor(data1$Accuracy, data2$Accuracy, method="spearman")
#determine the color the axis label will be based on the method
#matching it with the boxplot/violins i had without cancer type stratification
if(method1=="SimpleSigs"){
x.col = "#e07a5f"
} else if (method1 == "oncoPredict") {
x.col = "#6d597a"
} else if (method1 == "upSigs") {
x.col = "#6a040f"
} else if (method1 == "updownSigs") {
x.col = "#c9184a"
}
if(method2=="SimpleSigs"){
y.col = "#e07a5f"
} else if (method2 == "oncoPredict") {
y.col = "#6d597a"
} else if (method2 == "upSigs") {
y.col = "#6a040f"
} else if (method2 == "updownSigs") {
y.col = "#c9184a"
}
#plot with the legend, save individually
# plot_indiv = ggplot(data3, aes(x=method1_acc, y=method2_acc, col=subtype.x)) +
#   geom_point(size=2, alpha=0.8) +
#   scale_color_manual(values=c("#FF0000", "#A40000", "#D83601", "#D85701", "#D88D01",
#                               "#FFAB04", "#FFCD04", "#FFE204", "#E0E400", "#BAE400",
#                               "#A0E400", "#5BE400", "#0BFF48", "#23C200", "#01A851",
#                               "#03A46C", "#03CFA3", "#03CFB8", "#03BECF", "#02BEF2",
#                               "#028BC5", "#0264C5", "#0414CA", "#5234E8", "#7C34E8",
#                               "#A334E8", "#CA34E8", "#F03FE5", "#8C0C7F", "#8C0C41")) +
#   labs(title = "Accuracy Score Correlation",
#        subtitle=paste0("Spearman's rho = ", round(rho, 3)),
#        x=method1,
#        y=method2,
#        col="Disease Site") +
#   theme(axis.text=element_text(size=12))
#
# ggsave(here("Plots", "Method Comparison",
#             paste0(method1,".v.", method2, "_cor.png")),
#        plot=plot_indiv,
#        width=5, height=4)
#plot without legend, to put together in a multipanel figure
plot = ggplot(data3, aes(x=method1_acc, y=method2_acc)) +
geom_point(size=1, alpha=0.5) +
# scale_color_manual(values=c("#FF0000", "#A40000", "#D83601", "#D85701", "#D88D01",
#                             "#FFAB04", "#FFCD04", "#FFE204", "#E0E400", "#BAE400",
#                             "#A0E400", "#5BE400", "#0BFF48", "#23C200", "#01A851",
#                             "#03A46C", "#03CFA3", "#03CFB8", "#03BECF", "#02BEF2",
#                             "#028BC5", "#0264C5", "#0414CA", "#5234E8", "#7C34E8",
#                             "#A334E8", "#CA34E8", "#F03FE5", "#8C0C7F", "#8C0C41")) +
labs(title = paste0("rho = ", round(rho, 3)),
x=method1,
y=method2) +
scale_x_continuous(breaks=c(0, 0.5, 1)) +
scale_y_continuous(breaks=c(0, 0.5, 1)) +
theme(axis.text=element_text(size=12),
legend.position="none",
axis.title.x=element_text(color=x.col),
axis.title.y=element_text(color=y.col))
return(plot)
}
p1 = plot_cor(data=plot5,
method1="upSigs", method2="SimpleSigs")
p2 = plot_cor(data=plot5,
method1="upSigs", method2="oncoPredict")
p3 = plot_cor(data=plot5,
method1="upSigs", method2="updownSigs")
p4 = plot_cor(data=plot5,
method1="updownSigs", method2="SimpleSigs")
p5 = plot_cor(data=plot5,
method1="updownSigs", method2="oncoPredict")
p6 = plot_cor(data=plot5,
method1="oncoPredict", method2="SimpleSigs")
p1+p2+p3+p4+p5+p6 + plot_annotation(title="Accuracy Score Correlation")
ggsave(here("Plots", "Method Comparison", "spearman_method_comparison.png"),
width=5, height=4)
method_p = readRDS(here("Results", "wilcoxon_method_comparisons.rds"))
(ggplot(method_p, aes(x=p, y=subtype, col=comparison)) +
geom_text(aes(x=bonf.alpha, y=subtype), label="|", color="black",
inherit.aes=F, alpha=0.5) +
geom_label(data=method_p, aes(y = subtype, x = 0.00000008, #add n
label = n_cell_line), inherit.aes=F,
label.padding = unit(0.15, "lines"), label.size = 0.4, size = 3) +
geom_point(alpha=0.8, size=1) +
scale_color_manual(values=c("#9b2226", "#e85d04", "#faa307", "#fcca46",
"#4f772d", "#0a9396", "#023e8a",
"#5a189a", "#f26a8d",
"black")) +
scale_x_continuous(trans="log10", limits=c(0.00000008, 1)) +
labs(title = "P-values",
subtitle = "with Bonferroni-corrected alpha=0.05",
x="log10(p-value)", y="Disease Site",
col="Comparison") +
theme(legend.position="none",
axis.text=element_text(size=12),
axis.text.x = element_text(angle=30, hjust=1, vjust=1))) +
(ggplot(method_p, aes(x=p.adj,  y=subtype, col=comparison)) +
geom_label(data=method_p, aes(y = subtype, x = 0.00001, #add n
label = n_cell_line), inherit.aes=F,
label.padding = unit(0.15, "lines"), label.size = 0.4, size = 3) +
geom_vline(xintercept = 0.05, color="black") +
geom_point(alpha=0.8, size=1) +
scale_color_manual(values=c("#9b2226", "#e85d04", "#faa307", "#fcca46",
"#4f772d", "#0a9396", "#023e8a",
"#5a189a", "#f26a8d",
"black")) +
scale_x_continuous(trans="log10") +
labs(title = "FDR-Adjusted P-values",
subtitle = "with alpha = 0.05",
x="log10(Adjusted p-value)", y="Disease Site",
col="Comparison")+
theme(axis.text=element_text(size=12),
axis.text.x = element_text(angle=30, hjust=1, vjust=1)))
ggsave(here("Plots", "Method Comparison", "wilcoxon_p.png"),
width=8, height=4)
ggsave(here("Plots", "Method Comparison", "wilcoxon_p.png"),
width=8, height=5)
(ggplot(method_p, aes(x=p, y=subtype, col=comparison)) +
geom_text(aes(x=bonf.alpha, y=subtype), label="|", color="black",
inherit.aes=F, alpha=0.5) +
geom_label(data=method_p, aes(y = subtype, x = 0.00000008, #add n
label = n_cell_line), inherit.aes=F,
label.padding = unit(0.15, "lines"), label.size = 0.4, size = 4) +
geom_point(alpha=0.8, size=1) +
scale_color_manual(values=c("#9b2226", "#e85d04", "#faa307", "#fcca46",
"#4f772d", "#0a9396", "#023e8a",
"#5a189a", "#f26a8d",
"black")) +
scale_x_continuous(trans="log10", limits=c(0.00000008, 1)) +
labs(title = "P-values",
subtitle = "with Bonferroni-corrected alpha=0.05",
x="log10(p-value)", y="Disease Site",
col="Comparison") +
theme(legend.position="none",
axis.text=element_text(size=12),
axis.text.x = element_text(angle=30, hjust=1, vjust=1))) +
(ggplot(method_p, aes(x=p.adj,  y=subtype, col=comparison)) +
geom_label(data=method_p, aes(y = subtype, x = 0.00001, #add n
label = n_cell_line), inherit.aes=F,
label.padding = unit(0.15, "lines"), label.size = 0.4, size = 4) +
geom_vline(xintercept = 0.05, color="black") +
geom_point(alpha=0.8, size=1) +
scale_color_manual(values=c("#9b2226", "#e85d04", "#faa307", "#fcca46",
"#4f772d", "#0a9396", "#023e8a",
"#5a189a", "#f26a8d",
"black")) +
scale_x_continuous(trans="log10") +
labs(title = "FDR-Adjusted P-values",
subtitle = "with alpha = 0.05",
x="log10(Adjusted p-value)", y="Disease Site",
col="Comparison")+
theme(axis.text=element_text(size=12),
axis.text.x = element_text(angle=30, hjust=1, vjust=1)))
(ggplot(method_p, aes(x=p, y=subtype, col=comparison)) +
geom_text(aes(x=bonf.alpha, y=subtype), label="|", color="black",
inherit.aes=F, alpha=0.5) +
geom_label(data=method_p, aes(y = subtype, x = 0.00000008, #add n
label = n_cell_line), inherit.aes=F,
label.padding = unit(0.15, "lines"), label.size = 0.4, size = 4) +
geom_point(alpha=0.8, size=1) +
scale_color_manual(values=c("#9b2226", "#e85d04", "#faa307", "#fcca46",
"#4f772d", "#0a9396", "#023e8a",
"#5a189a", "#f26a8d",
"black")) +
scale_x_continuous(trans="log10", limits=c(0.00000008, 1)) +
labs(title = "P-values",
subtitle = "with Bonferroni-corrected alpha=0.05",
x="log10(p-value)", y="Disease Site",
col="Comparison") +
theme(legend.position="none",
axis.text=element_text(size=12),
axis.text.x = element_text(angle=30, hjust=1, vjust=1))) +
(ggplot(method_p, aes(x=p.adj,  y=subtype, col=comparison)) +
geom_label(data=method_p, aes(y = subtype, x = 0.00001, #add n
label = n_cell_line), inherit.aes=F,
label.padding = unit(0.15, "lines"), label.size = 0.4, size = 4) +
geom_vline(xintercept = 0.05, color="black") +
geom_point(alpha=0.8, size=1) +
scale_color_manual(values=c("#9b2226", "#e85d04", "#faa307", "#fcca46",
"#4f772d", "#0a9396", "#023e8a",
"#5a189a", "#f26a8d",
"black")) +
scale_x_continuous(trans="log10") +
labs(title = "FDR-Adjusted P-values",
subtitle = "with alpha = 0.05",
x="log10(Adjusted p-value)", y="Disease Site",
col="Comparison")+
theme(axis.text=element_text(size=12),
axis.text.x = element_text(angle=30, hjust=1, vjust=1)))
ggsave(here("Plots", "Method Comparison", "wilcoxon_p.png"),
width=8, height=5)
ggsave(here("Plots", "Method Comparison", "wilcoxon_p.png"),
width=9, height=6)
(ggplot(method_p, aes(x=p, y=subtype, col=comparison)) +
geom_text(aes(x=bonf.alpha, y=subtype), label="|", color="black",
inherit.aes=F, alpha=0.5) +
geom_label(data=method_p, aes(y = subtype, x = 0.00000008, #add n
label = n_cell_line), inherit.aes=F,
label.padding = unit(0.15, "lines"), label.size = 0.4, size = 4) +
geom_point(alpha=0.8, size=1) +
scale_color_manual(values=c("#9b2226", "#e85d04", "#faa307", "#fcca46",
"#4f772d", "#0a9396", "#023e8a",
"#5a189a", "#f26a8d",
"black")) +
scale_x_continuous(trans="log10", limits=c(0.00000008, 1)) +
labs(title = "P-values",
subtitle = "with Bonferroni-corrected alpha=0.05",
x="log10(p-value)", y="Disease Site",
col="Comparison") +
theme(legend.position="none",
axis.text=element_text(size=12),
axis.text.x = element_text(angle=30, hjust=1, vjust=1))) +
(ggplot(method_p, aes(x=p.adj,  y=subtype, col=comparison)) +
geom_label(data=method_p, aes(y = subtype, x = 0.00001, #add n
label = n_cell_line), inherit.aes=F,
label.padding = unit(0.15, "lines"), label.size = 0.4, size = 4) +
geom_vline(xintercept = 0.05, color="black") +
geom_point(alpha=0.8, size=1) +
scale_color_manual(values=c("#9b2226", "#e85d04", "#faa307", "#fcca46",
"#4f772d", "#0a9396", "#023e8a",
"#5a189a", "#f26a8d",
"black")) +
scale_x_continuous(trans="log10") +
labs(title = "FDR-Adjusted P-values",
subtitle = "with alpha = 0.05",
x="log10(Adjusted p-value)", y="Disease Site",
col="Comparison")+
theme(axis.text=element_text(size=14),
axis.text.x = element_text(angle=30, hjust=1, vjust=1)))
(ggplot(method_p, aes(x=p, y=subtype, col=comparison)) +
geom_text(aes(x=bonf.alpha, y=subtype), label="|", color="black",
inherit.aes=F, alpha=0.5) +
geom_label(data=method_p, aes(y = subtype, x = 0.00000008, #add n
label = n_cell_line), inherit.aes=F,
label.padding = unit(0.15, "lines"), label.size = 0.4, size = 4) +
geom_point(alpha=0.8, size=1) +
scale_color_manual(values=c("#9b2226", "#e85d04", "#faa307", "#fcca46",
"#4f772d", "#0a9396", "#023e8a",
"#5a189a", "#f26a8d",
"black")) +
scale_x_continuous(trans="log10", limits=c(0.00000008, 1)) +
labs(title = "P-values",
subtitle = "with Bonferroni-corrected alpha=0.05",
x="log10(p-value)", y="Disease Site",
col="Comparison") +
theme(legend.position="none",
axis.text=element_text(size=14),
axis.text.x = element_text(angle=30, hjust=1, vjust=1))) +
(ggplot(method_p, aes(x=p.adj,  y=subtype, col=comparison)) +
geom_label(data=method_p, aes(y = subtype, x = 0.00001, #add n
label = n_cell_line), inherit.aes=F,
label.padding = unit(0.15, "lines"), label.size = 0.4, size = 4) +
geom_vline(xintercept = 0.05, color="black") +
geom_point(alpha=0.8, size=1) +
scale_color_manual(values=c("#9b2226", "#e85d04", "#faa307", "#fcca46",
"#4f772d", "#0a9396", "#023e8a",
"#5a189a", "#f26a8d",
"black")) +
scale_x_continuous(trans="log10") +
labs(title = "FDR-Adjusted P-values",
subtitle = "with alpha = 0.05",
x="log10(Adjusted p-value)", y="Disease Site",
col="Comparison")+
theme(axis.text=element_text(size=14),
axis.text.x = element_text(angle=30, hjust=1, vjust=1)))
(ggplot(method_p, aes(x=p, y=subtype, col=comparison)) +
geom_text(aes(x=bonf.alpha, y=subtype), label="|", color="black",
inherit.aes=F, alpha=0.5) +
geom_label(data=method_p, aes(y = subtype, x = 0.00000008, #add n
label = n_cell_line), inherit.aes=F,
label.padding = unit(0.15, "lines"), label.size = 0.4, size = 4) +
geom_point(alpha=0.8, size=3) +
scale_color_manual(values=c("#9b2226", "#e85d04", "#faa307", "#fcca46",
"#4f772d", "#0a9396", "#023e8a",
"#5a189a", "#f26a8d",
"black")) +
scale_x_continuous(trans="log10", limits=c(0.00000008, 1)) +
labs(title = "P-values",
subtitle = "with Bonferroni-corrected alpha=0.05",
x="log10(p-value)", y="Disease Site",
col="Comparison") +
theme(legend.position="none",
axis.text=element_text(size=14),
axis.text.x = element_text(angle=30, hjust=1, vjust=1))) +
(ggplot(method_p, aes(x=p.adj,  y=subtype, col=comparison)) +
geom_label(data=method_p, aes(y = subtype, x = 0.00001, #add n
label = n_cell_line), inherit.aes=F,
label.padding = unit(0.15, "lines"), label.size = 0.4, size = 4) +
geom_vline(xintercept = 0.05, color="black") +
geom_point(alpha=0.8, size=3) +
scale_color_manual(values=c("#9b2226", "#e85d04", "#faa307", "#fcca46",
"#4f772d", "#0a9396", "#023e8a",
"#5a189a", "#f26a8d",
"black")) +
scale_x_continuous(trans="log10") +
labs(title = "FDR-Adjusted P-values",
subtitle = "with alpha = 0.05",
x="log10(Adjusted p-value)", y="Disease Site",
col="Comparison")+
theme(axis.text=element_text(size=14),
axis.text.x = element_text(angle=30, hjust=1, vjust=1)))
ggsave(here("Plots", "Method Comparison", "wilcoxon_p.png"),
width=9, height=6)
(ggplot(method_p, aes(x=p, y=subtype, col=comparison)) +
geom_text(aes(x=bonf.alpha, y=subtype), label="|", color="black",
inherit.aes=F, alpha=0.5) +
geom_label(data=method_p, aes(y = subtype, x = 0.00000008, #add n
label = n_cell_line), inherit.aes=F,
label.padding = unit(0.15, "lines"), label.size = 0.4, size = 4) +
geom_point(alpha=0.7, size=3) +
scale_color_manual(values=c("#9b2226", "#e85d04", "#faa307", "#fcca46",
"#4f772d", "#0a9396", "#023e8a",
"#5a189a", "#f26a8d",
"black")) +
scale_x_continuous(trans="log10", limits=c(0.00000008, 1)) +
labs(title = "P-values",
subtitle = "with Bonferroni-corrected alpha=0.05",
x="log10(p-value)", y="Disease Site",
col="Comparison") +
theme(legend.position="none",
axis.text=element_text(size=14),
axis.text.x = element_text(angle=30, hjust=1, vjust=1))) +
(ggplot(method_p, aes(x=p.adj,  y=subtype, col=comparison)) +
geom_label(data=method_p, aes(y = subtype, x = 0.00001, #add n
label = n_cell_line), inherit.aes=F,
label.padding = unit(0.15, "lines"), label.size = 0.4, size = 4) +
geom_vline(xintercept = 0.05, color="black") +
geom_point(alpha=0.7, size=3) +
scale_color_manual(values=c("#9b2226", "#e85d04", "#faa307", "#fcca46",
"#4f772d", "#0a9396", "#023e8a",
"#5a189a", "#f26a8d",
"black")) +
scale_x_continuous(trans="log10") +
labs(title = "FDR-Adjusted P-values",
subtitle = "with alpha = 0.05",
x="log10(Adjusted p-value)", y="Disease Site",
col="Comparison")+
theme(axis.text=element_text(size=14),
axis.text.x = element_text(angle=30, hjust=1, vjust=1)))
(ggplot(method_p, aes(x=p, y=subtype, col=comparison)) +
geom_text(aes(x=bonf.alpha, y=subtype), label="|", color="black",
inherit.aes=F, alpha=0.5) +
geom_label(data=method_p, aes(y = subtype, x = 0.00000008, #add n
label = n_cell_line), inherit.aes=F,
label.padding = unit(0.15, "lines"), label.size = 0.4, size = 4) +
geom_point(alpha=0.7, size=3) +
scale_color_manual(values=c("#9b2226", "#e85d04", "#faa307", "#fcca46",
"#4f772d", "#0a9396", "#023e8a",
"#5a189a", "#f26a8d",
"black")) +
scale_x_continuous(trans="log10", limits=c(0.00000008, 1)) +
labs(title = "P-values",
subtitle = "with Bonferroni-corrected alpha=0.05",
x="log10(p-value)", y="Disease Site",
col="Comparison") +
theme(legend.position="none",
axis.text=element_text(size=14),
axis.text.x = element_text(angle=30, hjust=1, vjust=1))) +
(ggplot(method_p, aes(x=p.adj,  y=subtype, col=comparison)) +
geom_label(data=method_p, aes(y = subtype, x = 0.00001, #add n
label = n_cell_line), inherit.aes=F,
label.padding = unit(0.15, "lines"), label.size = 0.4, size = 4) +
geom_vline(xintercept = 0.05, color="black") +
geom_point(alpha=0.7, size=3) +
scale_color_manual(values=c("#9b2226", "#e85d04", "#faa307", "#fcca46",
"#4f772d", "#0a9396", "#023e8a",
"#5a189a", "#f26a8d",
"black")) +
scale_x_continuous(trans="log10") +
labs(title = "FDR-Adjusted P-values",
subtitle = "with alpha = 0.05",
x="log10(Adjusted p-value)", y="Disease Site",
col="Comparison")+
theme(axis.text=element_text(size=14),
axis.text.x = element_text(angle=30, hjust=1, vjust=1)))
ggsave(here("Plots", "Method Comparison", "wilcoxon_p.png"),
width=9, height=6)
(ggplot(method_p, aes(x=p, y=subtype, col=comparison)) +
geom_text(aes(x=bonf.alpha, y=subtype), label="|", color="black",
inherit.aes=F, alpha=0.5) +
geom_label(data=method_p, aes(y = subtype, x = 0.00000008, #add n
label = n_cell_line), inherit.aes=F,
label.padding = unit(0.15, "lines"), label.size = 0.4, size = 4) +
geom_point(alpha=0.7, size=2.5) +
scale_color_manual(values=c("#9b2226", "#e85d04", "#faa307", "#fcca46",
"#4f772d", "#0a9396", "#023e8a",
"#5a189a", "#f26a8d",
"black")) +
scale_x_continuous(trans="log10", limits=c(0.00000008, 1)) +
labs(title = "P-values",
subtitle = "with Bonferroni-corrected alpha=0.05",
x="log10(p-value)", y="Disease Site",
col="Comparison") +
theme(legend.position="none",
axis.text=element_text(size=14),
axis.text.x = element_text(angle=30, hjust=1, vjust=1))) +
(ggplot(method_p, aes(x=p.adj,  y=subtype, col=comparison)) +
geom_label(data=method_p, aes(y = subtype, x = 0.00001, #add n
label = n_cell_line), inherit.aes=F,
label.padding = unit(0.15, "lines"), label.size = 0.4, size = 4) +
geom_vline(xintercept = 0.05, color="black") +
geom_point(alpha=0.7, size=2.5) +
scale_color_manual(values=c("#9b2226", "#e85d04", "#faa307", "#fcca46",
"#4f772d", "#0a9396", "#023e8a",
"#5a189a", "#f26a8d",
"black")) +
scale_x_continuous(trans="log10") +
labs(title = "FDR-Adjusted P-values",
subtitle = "with alpha = 0.05",
x="log10(Adjusted p-value)", y="Disease Site",
col="Comparison")+
theme(axis.text=element_text(size=14),
axis.text.x = element_text(angle=30, hjust=1, vjust=1)))
ggsave(here("Plots", "Method Comparison", "wilcoxon_p.png"),
width=9, height=6)
ggsave(here("Plots", "Method Comparison", "wilcoxon_p.png"),
width=9, height=7)
library(tidyverse)
View(method_p)
View(method_p %>% filter(comparison=="updownSigs.v.upSigs"))
