nrow=plot_rows) +
stat_summary(fun.data = give.n, geom = "text", fun.y = median,
position = position_dodge(width = 0.75),
aes(y=viol_n_displace), size = 5, angle = bar_n_angle) +
theme_bw(base_size = 15) + #theme and sizing
theme(axis.text.y = element_text(size = 20),
axis.text.x = element_text(size = 20),
legend.position = "none",
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text = element_text(size = 10))
ggplot(surv_sup, aes(x=rank, y=surv)) +
geom_violin(fill = "#b4cfc3", col = "#48705d") +
geom_boxplot(position="dodge", width=0.2,
col="#48705d", fill = "#6aa087") +
labs(title="Distribution of Survival by Predicted Sensitivity Ranking",
x="Sensitivity Ranking",
y="Survival")+
facet_wrap(~drug_abbrev,
labeller=as_labeller(setNames(sig_drugs, names(sig_labels))),
nrow=plot_rows) +
stat_summary(fun.data = give.n, geom = "text", fun.y = median,
position = position_dodge(width = 0.75),
aes(y=viol_n_displace), size = 5, angle = bar_n_angle) +
theme_bw(base_size = 15) + #theme and sizing
theme(axis.text.y = element_text(size = 20),
axis.text.x = element_text(size = 20),
legend.position = "none",
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text = element_text(size = 10))
ggplot(surv_sup, aes(x=rank, y=surv)) +
geom_violin() +
geom_boxplot(position="dodge", width=0.2) +
labs(title="Distribution of Survival by Predicted Sensitivity Ranking",
x="Sensitivity Ranking",
y="Survival")+
scale_color_manual(values = c("#dae7e1", "#c1d7cd", "#a8c7b9", "#8fb7a5", "#76a791",
"#5f957d", "#507c68", "#406453", "#304b3e", "#203229")) +
scale_fill_manual(values = c("#a8c7b9", "#8fb7a5", "#76a791", "#5f957d", "#507c68",
"#406453", "#304b3e", "#203229", "#080c0a", "#000000")) +
facet_wrap(~drug_abbrev,
labeller=as_labeller(setNames(sig_drugs, names(sig_labels))),
nrow=plot_rows) +
stat_summary(fun.data = give.n, geom = "text", fun.y = median,
position = position_dodge(width = 0.75),
aes(y=viol_n_displace), size = 5, angle = bar_n_angle) +
theme_bw(base_size = 15) + #theme and sizing
theme(axis.text.y = element_text(size = 20),
axis.text.x = element_text(size = 20),
legend.position = "none",
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text = element_text(size = 10))
ggplot(surv_sup, aes(x=rank, y=surv, col=rank, fill=rank)) +
geom_violin() +
geom_boxplot(position="dodge", width=0.2) +
labs(title="Distribution of Survival by Predicted Sensitivity Ranking",
x="Sensitivity Ranking",
y="Survival")+
scale_color_manual(values = c("#dae7e1", "#c1d7cd", "#a8c7b9", "#8fb7a5", "#76a791",
"#5f957d", "#507c68", "#406453", "#304b3e", "#203229")) +
scale_fill_manual(values = c("#a8c7b9", "#8fb7a5", "#76a791", "#5f957d", "#507c68",
"#406453", "#304b3e", "#203229", "#080c0a", "#000000")) +
facet_wrap(~drug_abbrev,
labeller=as_labeller(setNames(sig_drugs, names(sig_labels))),
nrow=plot_rows) +
stat_summary(fun.data = give.n, geom = "text", fun.y = median,
position = position_dodge(width = 0.75),
aes(y=viol_n_displace), size = 5, angle = bar_n_angle) +
theme_bw(base_size = 15) + #theme and sizing
theme(axis.text.y = element_text(size = 20),
axis.text.x = element_text(size = 20),
legend.position = "none",
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text = element_text(size = 10))
ggplot(surv_sup, aes(x=rank, y=surv, col=rank, fill=rank)) +
geom_violin() +
geom_boxplot(position="dodge", width=0.2) +
labs(title="Distribution of Survival by Predicted Sensitivity Ranking",
x="Sensitivity Ranking",
y="Survival")+
scale_color_manual(values = c("#a8c7b9", "#8fb7a5", "#76a791", "#5f957d", "#507c68",
"#406453", "#304b3e", "#203229", "#080c0a", "#000000")) +
scale_fill_manual(values = c("#dae7e1", "#c1d7cd", "#a8c7b9", "#8fb7a5", "#76a791",
"#5f957d", "#507c68", "#406453", "#304b3e", "#203229")) +
facet_wrap(~drug_abbrev,
labeller=as_labeller(setNames(sig_drugs, names(sig_labels))),
nrow=plot_rows) +
stat_summary(fun.data = give.n, geom = "text", fun.y = median,
position = position_dodge(width = 0.75),
aes(y=viol_n_displace), size = 5, angle = bar_n_angle) +
theme_bw(base_size = 15) + #theme and sizing
theme(axis.text.y = element_text(size = 20),
axis.text.x = element_text(size = 20),
legend.position = "none",
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text = element_text(size = 10))
ggplot(surv_sup, aes(x=rank, y=surv, col=rank, fill=rank)) +
geom_violin() +
geom_boxplot(position="dodge", width=0.2) +
labs(title="Distribution of Survival by Predicted Sensitivity Ranking",
x="Sensitivity Ranking",
y="Survival")+
scale_color_manual(values = c("#a8c7b9", "#8fb7a5", "#76a791", "#5f957d", "#507c68",
"#406453", "#304b3e", "#203229", "#080c0a", "#000000")) +
scale_fill_manual(values = c("#8fb7a5", "#8fb7a5", "#76a791", "#76a791", "#5f957d",
"#5f957d", "#507c68", "#406453", "#304b3e", "#203229")) +
facet_wrap(~drug_abbrev,
labeller=as_labeller(setNames(sig_drugs, names(sig_labels))),
nrow=plot_rows) +
stat_summary(fun.data = give.n, geom = "text", fun.y = median,
position = position_dodge(width = 0.75),
aes(y=viol_n_displace), size = 5, angle = bar_n_angle) +
theme_bw(base_size = 15) + #theme and sizing
theme(axis.text.y = element_text(size = 20),
axis.text.x = element_text(size = 20),
legend.position = "none",
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text = element_text(size = 10))
ggplot(surv_sup, aes(x=rank, y=surv, col=rank, fill=rank)) +
geom_violin() +
geom_boxplot(position="dodge", width=0.2) +
labs(title="Distribution of Survival by Predicted Sensitivity Ranking",
x="Sensitivity Ranking",
y="Survival")+
scale_color_manual(values = c("#5f957d", "#5f957d", "#5f957d", "#5f957d", "#406453",
"#406453", "#304b3e", "#203229", "#080c0a", "#000000")) +
scale_fill_manual(values = c("#dae7e1", "#c1d7cd", "#a8c7b9", "#8fb7a5", "#76a791",
"#5f957d", "#507c68", "#406453", "#304b3e", "#203229")) +
facet_wrap(~drug_abbrev,
labeller=as_labeller(setNames(sig_drugs, names(sig_labels))),
nrow=plot_rows) +
stat_summary(fun.data = give.n, geom = "text", fun.y = median,
position = position_dodge(width = 0.75),
aes(y=viol_n_displace), size = 5, angle = bar_n_angle) +
theme_bw(base_size = 15) + #theme and sizing
theme(axis.text.y = element_text(size = 20),
axis.text.x = element_text(size = 20),
legend.position = "none",
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text = element_text(size = 10))
ggplot(surv_sup, aes(x=rank, y=surv, col=rank, fill=rank)) +
geom_violin() +
geom_boxplot(position="dodge", width=0.2) +
labs(title="Distribution of Survival by Predicted Sensitivity Ranking",
x="Sensitivity Ranking",
y="Survival")+
scale_color_manual(values = c("#5f957d", "#5f957d", "#5f957d", "#406453", "#406453",
"#406453", "#304b3e", "#203229", "#080c0a", "#000000")) +
scale_fill_manual(values = c("#dae7e1", "#c1d7cd", "#a8c7b9", "#8fb7a5", "#76a791",
"#5f957d", "#507c68", "#406453", "#304b3e", "#203229")) +
facet_wrap(~drug_abbrev,
labeller=as_labeller(setNames(sig_drugs, names(sig_labels))),
nrow=plot_rows) +
stat_summary(fun.data = give.n, geom = "text", fun.y = median,
position = position_dodge(width = 0.75),
aes(y=viol_n_displace), size = 5, angle = bar_n_angle) +
theme_bw(base_size = 15) + #theme and sizing
theme(axis.text.y = element_text(size = 20),
axis.text.x = element_text(size = 20),
legend.position = "none",
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text = element_text(size = 10))
ggplot(surv_sup, aes(x=rank, y=surv, col=rank, fill=rank)) +
geom_violin() +
geom_boxplot(position="dodge", width=0.2) +
labs(title="Distribution of Survival by Predicted Sensitivity Ranking",
x="Sensitivity Ranking",
y="Survival")+
scale_color_manual(values = c("#5f957d", "#5f957d", "#5f957d", "#406453", "#406453",
"#406453", "#304b3e", "#203229", "#000000", "#000000")) +
scale_fill_manual(values = c( "#fcfaf9", "#dae7e1", "#c1d7cd", "#a8c7b9", "#8fb7a5", "#76a791",
"#5f957d", "#507c68", "#406453", "#304b3e")) +
facet_wrap(~drug_abbrev,
labeller=as_labeller(setNames(sig_drugs, names(sig_labels))),
nrow=plot_rows) +
stat_summary(fun.data = give.n, geom = "text", fun.y = median,
position = position_dodge(width = 0.75),
aes(y=viol_n_displace), size = 5, angle = bar_n_angle) +
theme_bw(base_size = 15) + #theme and sizing
theme(axis.text.y = element_text(size = 20),
axis.text.x = element_text(size = 20),
legend.position = "none",
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text = element_text(size = 10))
ggplot(surv_sup, aes(x=rank, y=surv, col=rank, fill=rank)) +
geom_violin() +
geom_boxplot(position="dodge", width=0.2) +
labs(title="Distribution of Survival by Predicted Sensitivity Ranking",
x="Sensitivity Ranking",
y="Survival")+
scale_color_manual(values = c("#5f957d", "#5f957d", "#5f957d", "#406453", "#406453",
"#406453", "#304b3e", "#203229", "#000000", "#000000")) +
scale_fill_manual(values = c( "#fcfaf9", "#dae7e1", "#c1d7cd", "#a8c7b9", "#8fb7a5", "#76a791",
"#5f957d", "#507c68", "#48705c", "#406453")) +
facet_wrap(~drug_abbrev,
labeller=as_labeller(setNames(sig_drugs, names(sig_labels))),
nrow=plot_rows) +
stat_summary(fun.data = give.n, geom = "text", fun.y = median,
position = position_dodge(width = 0.75),
aes(y=viol_n_displace), size = 5, angle = bar_n_angle) +
theme_bw(base_size = 15) + #theme and sizing
theme(axis.text.y = element_text(size = 20),
axis.text.x = element_text(size = 20),
legend.position = "none",
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text = element_text(size = 10))
ggsave(here("Plots", paste0(length(sigs), "sig_prediction_surv.png")),
width=15, height=8)
ggplot(surv_sup, aes(x=rank, y=surv, col=rank, fill=rank)) +
# geom_violin() +
geom_boxplot(position="dodge") +
labs(title="Distribution of Survival by Predicted Sensitivity Ranking",
x="Sensitivity Ranking",
y="Survival")+
scale_color_manual(values = c("#5f957d", "#5f957d", "#5f957d", "#406453", "#406453",
"#406453", "#304b3e", "#203229", "#000000", "#000000")) +
scale_fill_manual(values = c( "#fcfaf9", "#dae7e1", "#c1d7cd", "#a8c7b9", "#8fb7a5",
"#76a791","#5f957d", "#507c68", "#48705c", "#406453")) +
facet_wrap(~drug_abbrev,
labeller=as_labeller(setNames(sig_drugs, names(sig_labels))),
nrow=plot_rows) +
stat_summary(fun.data = give.n, geom = "text", fun.y = median,
position = position_dodge(width = 0.75),
aes(y=viol_n_displace), size = 5, angle = bar_n_angle) +
theme_bw(base_size = 15) + #theme and sizing
theme(axis.text.y = element_text(size = 20),
axis.text.x = element_text(size = 20),
legend.position = "none",
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text = element_text(size = 10))
ggsave(here("Plots", paste0(length(sigs), "sig_prediction_surv.png")),
width=15, height=8)
ggplot(surv_sup %>% filter(subtype %in% epi), aes(x=rank, y=surv)) +
geom_boxplot(position="dodge") +
labs(title="Distribution of Survival by Predicted Sensitivity Ranking",
subtitle = "in Epithelial Cancers",
x="Sensitivity Ranking",
y="Survival")+
scale_color_manual(values = c("#5f957d", "#5f957d", "#5f957d", "#406453", "#406453",
"#406453", "#304b3e", "#203229", "#000000", "#000000")) +
scale_fill_manual(values = c( "#fcfaf9", "#dae7e1", "#c1d7cd", "#a8c7b9", "#8fb7a5",
"#76a791","#5f957d", "#507c68", "#48705c", "#406453")) +
facet_wrap(~drug_abbrev,
labeller=as_labeller(setNames(sig_drugs, names(sig_labels))),
nrow=plot_rows) +
stat_summary(fun.data = give.n, geom = "text", fun.y = median,
position = position_dodge(width = 0.75),
aes(y=viol_n_displace), size = 5, angle = bar_n_angle) +
theme_bw(base_size = 15) + #theme and sizing
theme(axis.text.y = element_text(size = 20),
axis.text.x = element_text(size = 20),
legend.position = "none",
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text = element_text(size = 10))
ggplot(surv_sup %>% filter(subtype %in% epi), aes(x=rank, y=surv, fill=rank, col=rank)) +
geom_boxplot(position="dodge") +
labs(title="Distribution of Survival by Predicted Sensitivity Ranking",
subtitle = "in Epithelial Cancers",
x="Sensitivity Ranking",
y="Survival")+
scale_color_manual(values = c("#5f957d", "#5f957d", "#5f957d", "#406453", "#406453",
"#406453", "#304b3e", "#203229", "#000000", "#000000")) +
scale_fill_manual(values = c( "#fcfaf9", "#dae7e1", "#c1d7cd", "#a8c7b9", "#8fb7a5",
"#76a791","#5f957d", "#507c68", "#48705c", "#406453")) +
facet_wrap(~drug_abbrev,
labeller=as_labeller(setNames(sig_drugs, names(sig_labels))),
nrow=plot_rows) +
stat_summary(fun.data = give.n, geom = "text", fun.y = median,
position = position_dodge(width = 0.75),
aes(y=viol_n_displace), size = 5, angle = bar_n_angle) +
theme_bw(base_size = 15) + #theme and sizing
theme(axis.text.y = element_text(size = 20),
axis.text.x = element_text(size = 20),
legend.position = "none",
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text = element_text(size = 10))
ggsave(here("Plots", "Epithelial Cancers",
paste0(length(sigs), "sig_prediction_surv_epi.png")),
width=15, height=8)
sigs = sigs[c(1,3,4)]
sig_drugs=sig_drugs[c(1,3,4)]
fit_results = readRDS(here("Results",
paste0(length(sigs), "sig_nlme_fitted_data.rds")))
scores=readRDS(here("Results",
paste0(length(sigs), "sig_scores.rds")))
scores = na.omit(scores)
scores_long = pivot_longer(scores,
cols = c(names(sigs)),
names_to = "drug_abbrev",
values_to = "score")
scored_ranks = readRDS(here("Results", paste0(length(sigs),"sig_accuracy_scores.rds")))
#all the values with NA had missing drug response data and should be excluded
nrow(scored_ranks)
scored_ranks_full = na.omit(scored_ranks) #986 to 759 for 3 sigs, 616 after rm unclassified cell lines
#968 to 670 for 10sig, 539 after rm unclass.
nrow(scored_ranks_full)
#create a new df with one row per subtype, and columns = subtype, proportion_correct
subtype = unique(scored_ranks_full$subtype)
subtype_scores = data.frame(subtype=subtype, accuracy=0, n = 0)
for (i in 1:length(subtype)){
#Subset data per subtype
subset = scored_ranks_full[which(scored_ranks_full$subtype == subtype[i]),]
#Store subtype name
subtype_scores$subtype[i] = subtype[i]
#calc and store % of cell line survivals correctly predicted
subtype_scores$accuracy[i] = round((sum(subset$accuracy)/nrow(subset)), digits=3)
#Indicate number of cell lines in subtype (n)
subtype_scores$n[i] = nrow(subset)
}
#order the rows by highest to lowest correct
subtype_scores = subtype_scores[order(subtype_scores$accuracy),]
#To maintain this order when we plot later, factorize the column
subtype_scores$subtype <- factor(subtype_scores$subtype,
ordered = TRUE,
levels = subtype_scores$subtype)
#remove unclassified cell lines
scored_ranks_full = scored_ranks_full %>% filter(subtype != "UNCLASSIFIED")
#Set order to = subtype_scores
cancer_order = (as.character(subtype_scores$subtype))[-c(which(as.character(subtype_scores$subtype)=="UNCLASSIFIED"))]
scored_ranks_full$subtype <- factor(scored_ranks_full$subtype,
ordered = TRUE,
levels = c(cancer_order))
scored_ranks_full = scored_ranks_full[order(scored_ranks_full$subtype),]
#remove unclassified from subtype score averages
subtype_scores$subtype <- factor(subtype_scores$subtype,
ordered = TRUE,
levels = c(cancer_order))
subtype_scores = subtype_scores[order(subtype_scores$subtype),]
#save
saveRDS(scored_ranks_full, here("Results", paste0(length(sigs),"sig_accuracy_scores_cleaned.rds")))
scored_ranks_epi = scored_ranks_full %>%
filter(subtype %in% epi)
scores_sup = data.frame(matrix(nrow=0, ncol=(ncol(scores_long)+1)))
colnames(scores_sup) = c(colnames(scores_long), "rank")
#create a vector of all the cell lines to go through
cl_list = unique(scores_long$cell_line)
for(i in 1:length(cl_list)){
#for each cell line, sort by descending sig score (most to least sensitive)
temp = scores_long %>% filter(cell_line == cl_list[i])
temp = temp[order(temp$score, decreasing = TRUE),]
temp$rank = seq(1:nrow(temp)) #label the ranking from most to least sensitive
scores_sup = rbind(scores_sup, temp) #combine results with the previous iteration
}
rm(temp)
scores_sup = scores_sup %>%
filter(subtype != "UNCLASSIFIED") %>%
mutate(rank = factor(rank, ordered=TRUE,
levels = seq(1:length(sigs))))
#set some plotting parameters based on number of sigs used
if(length(sigs) <= 5){
plot_rows = 1
bar_n_displace = -10
bar_n_angle = 0
bar_n_size = 5
viol_n_displace = -0.03
} else {
plot_rows = 2
bar_n_displace = -20
bar_n_angle = 45
bar_n_size = 4
viol_n_displace = -0.05
}
surv_sup = merge(scores_sup, fit_results,
by=c("cell_line", "subtype", "drug_abbrev"))
ggplot(surv_sup, aes(x=rank, y=surv, col=rank, fill=rank)) +
geom_boxplot(position="dodge") +
labs(title="Distribution of Survival by Predicted Sensitivity Ranking",
x="Sensitivity Ranking",
y="Survival")+
scale_color_manual(values = c("#5f957d", "#5f957d", "#5f957d", "#406453", "#406453",
"#406453", "#304b3e", "#203229", "#000000", "#000000")) +
scale_fill_manual(values = c( "#fcfaf9", "#dae7e1", "#c1d7cd", "#a8c7b9", "#8fb7a5",
"#76a791","#5f957d", "#507c68", "#48705c", "#406453")) +
facet_wrap(~drug_abbrev,
labeller=as_labeller(setNames(sig_drugs, names(sig_labels))),
nrow=plot_rows) +
stat_summary(fun.data = give.n, geom = "text", fun.y = median,
position = position_dodge(width = 0.75),
aes(y=viol_n_displace), size = 5, angle = bar_n_angle) +
theme_bw(base_size = 15) + #theme and sizing
theme(axis.text.y = element_text(size = 20),
axis.text.x = element_text(size = 20),
legend.position = "none",
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text = element_text(size = 10))
#set some plotting parameters based on number of sigs used
if(length(sigs) <= 5){
plot_rows = 1
bar_n_displace = -10
bar_n_angle = 0
bar_n_size = 5
viol_n_displace = -0.03
col_values = c("#5f957d", "#406453", "#304b3e", "#203229", "#000000")[1:length(sigs)]
fill_values = c("#c1d7cd", "#8fb7a5", "#507c68", "#48705c", "#406453")[1:length(sigs)]
} else {
plot_rows = 2
bar_n_displace = -20
bar_n_angle = 45
bar_n_size = 4
viol_n_displace = -0.05
col_values = c("#5f957d", "#5f957d", "#5f957d", "#406453", "#406453",
"#406453", "#304b3e", "#203229", "#000000", "#000000")[1:length(sigs)]
fill_values = c("#fcfaf9", "#dae7e1", "#c1d7cd", "#a8c7b9", "#8fb7a5",
"#76a791","#5f957d", "#507c68", "#48705c", "#406453")[1:length(sigs)]
}
ggplot(surv_sup, aes(x=rank, y=surv, col=rank, fill=rank)) +
geom_boxplot(position="dodge") +
labs(title="Distribution of Survival by Predicted Sensitivity Ranking",
x="Sensitivity Ranking",
y="Survival")+
scale_color_manual(values = col_values) +
scale_fill_manual(values = fill_values) +
facet_wrap(~drug_abbrev,
labeller=as_labeller(setNames(sig_drugs, names(sig_labels))),
nrow=plot_rows) +
stat_summary(fun.data = give.n, geom = "text", fun.y = median,
position = position_dodge(width = 0.75),
aes(y=viol_n_displace), size = 5, angle = bar_n_angle) +
theme_bw(base_size = 15) + #theme and sizing
theme(axis.text.y = element_text(size = 20),
axis.text.x = element_text(size = 20),
legend.position = "none",
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text = element_text(size = 10))
sig_labels = list()
for(i in 1:length(sigs)){
sig_labels[[i]] = sig_drugs[i]
names(sig_labels)[i] = names(sigs)[i]
}
#make a function to label number of cell lines represented in each col
give.n <- function(x){
return(c(y = median(x)*1.05, label = length(x)))
# experiment with the multiplier to find the perfect position
}
ggplot(surv_sup, aes(x=rank, y=surv, col=rank, fill=rank)) +
geom_boxplot(position="dodge") +
labs(title="Distribution of Survival by Predicted Sensitivity Ranking",
x="Sensitivity Ranking",
y="Survival")+
scale_color_manual(values = col_values) +
scale_fill_manual(values = fill_values) +
facet_wrap(~drug_abbrev,
labeller=as_labeller(setNames(sig_drugs, names(sig_labels))),
nrow=plot_rows) +
stat_summary(fun.data = give.n, geom = "text", fun.y = median,
position = position_dodge(width = 0.75),
aes(y=viol_n_displace), size = 5, angle = bar_n_angle) +
theme_bw(base_size = 15) + #theme and sizing
theme(axis.text.y = element_text(size = 20),
axis.text.x = element_text(size = 20),
legend.position = "none",
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text = element_text(size = 10))
ggsave(here("Plots", paste0(length(sigs), "sig_prediction_surv.png")),
width=15, height=8)
ggplot(surv_sup %>% filter(subtype %in% epi), aes(x=rank, y=surv, fill=rank, col=rank)) +
geom_boxplot(position="dodge") +
labs(title="Distribution of Survival by Predicted Sensitivity Ranking",
subtitle = "in Epithelial Cancers",
x="Sensitivity Ranking",
y="Survival")+
scale_color_manual(values = col_values) +
scale_fill_manual(values = fill_values) +
facet_wrap(~drug_abbrev,
labeller=as_labeller(setNames(sig_drugs, names(sig_labels))),
nrow=plot_rows) +
stat_summary(fun.data = give.n, geom = "text", fun.y = median,
position = position_dodge(width = 0.75),
aes(y=viol_n_displace), size = 5, angle = bar_n_angle) +
theme_bw(base_size = 15) + #theme and sizing
theme(axis.text.y = element_text(size = 20),
axis.text.x = element_text(size = 20),
legend.position = "none",
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text = element_text(size = 10))
ggsave(here("Plots", "Epithelial Cancers",
paste0(length(sigs), "sig_prediction_surv_epi.png")),
width=15, height=8)
ggplot(surv_sup, aes(x=as.numeric(rank), y=surv)) +
geom_point(fill = "#b4cfc3", col = "#48705d", alpha=0.5) +
labs(title="Distribution of Survival by Predicted Sensitivity Ranking",
x="Sensitivity Ranking",
y="Survival")+
facet_wrap(~drug_abbrev,
labeller=as_labeller(setNames(sig_drugs, names(sig_labels))),
nrow=plot_rows) +
stat_summary(fun.data = give.n, geom = "text", fun.y = median,
position = position_dodge(width = 0.75),
aes(y=viol_n_displace), size = 5, angle = bar_n_angle) +
theme_bw(base_size = 15) + #theme and sizing
theme(axis.text.y = element_text(size = 20),
axis.text.x = element_text(size = 20),
legend.position = "none",
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
axis.text = element_text(size = 10))
